<!DOCTYPE html>
<html>
<head>
    <title>my-first-app</title>

    <script type="text/javascript" src="/apps/2.0/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define('CustomApp', {
    extend: 'Rally.app.App',
    componentCls: 'app',
    
    items: [
        {html: 'my-first-app'},
        {xtype: 'rallyreleasecombobox'},
        {xtype: 'rallyiterationcombobox'}
    ],
    //layout: 'hbox',
    
    
    //Default funciton launched by app
    launch: function() {
        console.log('Test log to console');
        
        this._loadData();
    },
    
    
    //Load data from Rally
    _loadData: function() {
        var myStore = Ext.create('Rally.data.wsapi.Store', {
            model: 'User Story',
            autoLoad: true,
            listeners: {
                load: function(myStore, myData, success) {
                    console.log('got data', myStore, myData, success);
                    
                    this._loadGrid(myStore);
                },
                scope: this
            },
            fetch: ['Name', 'ScheduleState', 'FormattedID']
        });
    },
    
    
    //Load and display Grid
    _loadGrid: function(myStoryStore) {
        var myGrid = Ext.create('Rally.ui.grid.Grid', {
            store: myStoryStore,
            columnCfgs: [
                'FormattedID',
                'Name',
                'ScheduleState'
                ]
        });
        
        console.log('my grid', myGrid);
        
        console.log('what is this?', this);
        this.add(myGrid);
        
    },

    
    
    
/*    
    //original code
    launch: function() {
        //Write app code here
        console.log('Test log to console');
        
        var myStore = Ext.create('Rally.data.wsapi.Store', {
            model: 'User Story',
            autoLoad: true,
            listeners: {
                load: function(myStore, myData, success) {
                    console.log('got data', myStore, myData, success);
                    //process data
                    
                    var myGrid = Ext.create('Rally.ui.grid.Grid', {
                        store: myStore,
                        columnCfgs: [
                            'FormattedID',
                            'Name',
                            'ScheduleState'
                            ]
                    });
                    
                    console.log('my grid', myGrid);
                    
                    console.log('what is this?', this);
                    this.add(myGrid);
                },
                scope: this
            },
            fetch: ['Name', 'ScheduleState', 'FormattedID']
        });

        //API Docs: https://help.rallydev.com/apps/2.0/doc/
    }
*/


});


            Rally.launchApp('CustomApp', {
                name:"my-first-app",
	            parentRepos:""
            });

        });
    </script>



    <style type="text/css">
        .app {
  /* Add app styles here */
}

    </style>
</head>
<body>
</body>
</html>
